"0","# Define a simple function that can update weights beta"
"0","# given a _vector_ x and a length 1 label y."
"0","# So each call to perceptron will run one step of the algorithm by looking at"
"0","# one data point."
"0","perceptron <- function(x, y, beta, lr = 1) {"
"0","  # Get the prediction"
"0","  y_hat <- sign(t(beta) %*% x)[1]"
"0","  # Update the betas if incorrect"
"0","  beta <- beta + (y != y_hat)*lr*(y*x)"
"0","  # Return"
"0","  beta"
"0","}"
"0",""
"0","accuracy <- function(x, y, beta) {"
"0","  y_hat <- apply(x, 1, function(.x) sign(t(beta) %*% .x))"
"0","  mean(y == y_hat)"
"0","}"
