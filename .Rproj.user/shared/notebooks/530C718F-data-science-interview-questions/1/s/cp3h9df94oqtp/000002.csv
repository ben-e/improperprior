"0","# Initialize some very wrong weights."
"0","beta <- c(1000, 1000)"
"0",""
"0","# Should be 0."
"0","print(paste0(""Initial Accuracy: "", accuracy(x, y, beta)))"
"1","[1]"
"1"," ""Initial Accuracy: 0"""
"1","
"
"0","# Iterate over the data"
"0","n_epochs <- 100"
"0","for (epoch in 1:n_epochs) {"
"0","  # Shuffle data"
"0","  shuffle <- sample(1:nrow(x))"
"0","  x <- x[shuffle, ]"
"0","  y <- y[shuffle]"
"0","  "
"0","  # Update, one observation at a time"
"0","  # Note that I'm letting the learning rate step down so that it can"
"0","  # initially take very large steps, then smaller and smaller steps."
"0","  # I'm not actually sure if this helps..anything"
"0","  for (row in nrow(x)) {"
"0","    beta <- perceptron(x[row, ], y[row], beta, lr = n_epochs/epoch)"
"0","  }"
"0","  "
"0","  # Progress report"
"0","  if (epoch %% 25 == 0)"
"0","    print(paste0(""Epoch: "", epoch, ""; Accuracy: "", accuracy(x, y, beta)))"
"0","}"
"1","[1]"
"1"," ""Epoch: 25; Accuracy: 0.038"""
"1","
"
"1","[1]"
"1"," ""Epoch: 50; Accuracy: 0.612"""
"1","
"
"1","[1]"
"1"," ""Epoch: 75; Accuracy: 0.9"""
"1","
"
"1","[1]"
"1"," ""Epoch: 100; Accuracy: 0.902"""
"1","
"
