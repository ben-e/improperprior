"0","sgd_beta_hat <- starting_beta_hat"
"0","n_epochs <- 100"
"0","lr <- 1e-2"
"0",""
"0","for (epoch in 1:n_epochs) {"
"0","  # Split thed data into batches"
"0","  batches <- split(sample.int(n), seq(1, n, 4))"
"0","  "
"0","  # Update for each batch"
"0","  for (batch in batches) {"
"0","    # Get predictions using the current weights"
"0","    y_hat <- sigm(x[batch, ], sgd_beta_hat)"
"0","    "
"0","    # Get the gradient"
"0","    grad <- c(t(x[batch, ]) %*% (y[batch] - y_hat))"
"0","    "
"0","    # And update the parameters"
"0","    sgd_beta_hat <- sgd_beta_hat + lr*grad"
"0","  }"
"0","}"
"0",""
"0","# And let's look at how well we did."
"0","rbind(true_beta = true_beta,"
"0","      beta_hat = beta_hat,"
"0","      sgd_beta_hat  = sgd_beta_hat,"
"0","      starting_beta_hat = starting_beta_hat)"
"1","                 "
"1","       [,1]"
"1","       [,2]"
"1","     [,3]"
"1","     [,4]"
"1","
true_beta        "
"1","   4.000000"
"1","   5.000000"
"1"," 2.000000"
"1"," 3.000000"
"1","
beta_hat         "
"1","   4.104327"
"1","   5.133133"
"1"," 2.040719"
"1"," 3.103220"
"1","
sgd_beta_hat     "
"1","   4.001634"
"1","   5.196838"
"1"," 2.040246"
"1"," 3.177115"
"1","
starting_beta_hat"
"1"," -11.771508"
"1"," -10.567567"
"1"," 5.889800"
"1"," 2.699790"
"1","
"
